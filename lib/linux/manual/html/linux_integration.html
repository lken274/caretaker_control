<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>Caretaker Library API 1.6.5 Reference Manual: Library Integration</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Caretaker Library API 1.6.5 Reference Manual
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Library Integration </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This section provides an overview of the library integration with Linux applications.</p>
<h2>Library Package</h2>
<p>Linux versions of the library are released in zip format <em>ctlibrary-linux-ARCH-VERSION.zip</em> for use with Linux applications, where <em>ARCH</em> is the target platform architecture, and <em>VERSION</em> is the library version bundling the following components.</p>
<table class="doxtable">
<tr>
<th>Component </th><th>Description </th></tr>
<tr>
<td><a class="el" href="caretaker_8h_source.html">caretaker.h</a> </td><td>Header file exposing the Caretaker APIs to the application. </td></tr>
<tr>
<td>libcaretaker.a </td><td>Caretaker library image to use for static linking with the application. </td></tr>
<tr>
<td>libcaretaker.so </td><td>Caretaker library image to use for dynamic linking with the application. </td></tr>
<tr>
<td>libbluetooth.a </td><td>Precompiled version of the BlueZ Linux Bluetooth library for static linking provided for convenience. </td></tr>
<tr>
<td>libbluetooth.so </td><td>Precompiled version of the BLueZ Linux Bluetooth library for dynamic linking provided for conveniece. </td></tr>
<tr>
<td>manual </td><td>The library API documentation. Documentation is available in pdf and html formats. The pdf version is supplied for completeness though the formatting is optimized for viewing in html format. For viewing the html version main page open <em>html/index.html</em>. </td></tr>
<tr>
<td>examples </td><td>Examples illustrating library use. </td></tr>
</table>
<h2>Supported Platforms</h2>
<p>This library version links with Ubuntu and Debian applications running on x86 and ARM based platforms. </p>
<p>The library was tested on the following Linux systems. </p>
<ul>
<li>
Linux systems with Ubuntu 14.04 or later </li>
<li>
Raspberry Pi with Raspbian 9.1 or later </li>
</ul>
<h2>Software Configuration</h2>
<p>Ubuntu 14.04, Linux kernel 4.4.0-72-generic or later must be installed on the computer that will execute the library targeting Ubuntu application. </p>
<p>Raspbian 9.1, Linux kernel 4.9.59-v7 or late must be installed on the computer that will execute the library targeting Raspberry Pi application.</p>
<h2>Hardware Configuration</h2>
<p>If the Linux computer that will run the application does not have Bluetooth support or the Bluetooth hardware is not current, you will need the CSR8510 A10 BLE dongle or similar to enable the computer to communicate with the Caretaker device. If so, plug the dongle into a USB port on the computer and then run the following commands to configure it. Replace <em>hcin</em> with the actual host control interface name printed in the hcitool output for the dongle.</p>
<div class="fragment"><div class="line">hcitool dev</div>
<div class="line">sudo hciconfig &lt;hcin&gt; reset</div>
</div><!-- fragment --><h2>Linking with the Library</h2>
<p>Linux applications can link the with the library using either static or dynamic linking.</p>
<h3>Static Linking</h3>
<p>For static linking, the static library image <em>libcaretaker.a</em> and the supplied <em>libbluetooth.a</em> for BLE communication will need to be linked to the application. Copy these two library images to the application project library directory and link them as follows if compiling with <em>gcc</em>.</p>
<div class="fragment"><div class="line">$(PROG): $(OBJS)</div>
<div class="line">    gcc -<span class="keyword">static</span> -o $@ $^ $(LIBS)/libcaretaker-VERSION.a $(LIBS)/libbluetooth.a -lpthread</div>
</div><!-- fragment --><p>Where <em>PROG</em> is the application program name, <em>OBJS</em> are the application object files, and <em>LIBS</em> is the path to the project library directory. Note the caretaker library uses POSIX threads so <em>-lpthread</em> is required to link the pthread library.</p>
<h3>Dynamic Linking</h3>
<p>For dynamic linking, the dynamic library image <em>libcaretaker.so</em> and the supplied <em>libbluetooth.so</em> for BLE communication will need to be linked to the application. Copy these library images to the application project library directory and link them as follows if compiling with <em>gcc</em>.</p>
<div class="fragment"><div class="line">$(PROG): $(OBJS)</div>
<div class="line">    gcc -o $@ $^ -lcaretaker-linux-VERSION -lbluetooth -lpthread -L$(LIBS)</div>
</div><!-- fragment --><p>Where <em>PROG</em> is the application program name, <em>OBJS</em> are the application object files, and <em>LIBS</em> is the path to the project library directory. Note the caretaker library uses POSIX threads so <em>-lpthread</em> is required to link the pthread library.</p>
<h2>Debugging</h2>
<p>The library supports generating log messages with the following levels of verbosity.</p>
<table class="doxtable">
<tr>
<th>Log Level </th><th>Description </th></tr>
<tr>
<td>0 </td><td>Show all log messages. This is the most verbose level. </td></tr>
<tr>
<td>1 </td><td>Show informational, warning, and error messages only. </td></tr>
<tr>
<td>2 </td><td>Show warning and error messages only. </td></tr>
<tr>
<td>3 </td><td>Show error mesages only. This is the least verbose level. </td></tr>
</table>
<p>You can call <a class="el" href="group__unmanaged__secondary__api.html#ga0f4a1a0099592a7a0ddb1053d7a7e888" title="Sets the library log level. ">libct_set_log_level()</a> from the application code to set the log level.</p>
<p>Log messages are written to standard output (stdout) and will be printed to the terminal window where the application was started by default. So to view the log messages, the application must be started from the terminal window explicilty. The logs can be viewed and saved as follows assuming <em>appExe</em> is the application executable.</p>
<div class="fragment"><div class="line">appExe | tee libcaretaker.log</div>
</div><!-- fragment --><p>Log messages from the library code will have the following format.</p>
<div class="fragment"><div class="line">DATE       TIME         LEVEL/FILTER   THREAD  MESSAGE</div>
<div class="line">---------- ------------ -------------- ------- ------------------------------------------------</div>
<div class="line">2018-08-01 14:47:34.632 I/libcaretaker (10592) <a class="code" href="group__unmanaged__primary__api.html#ga8577c848cdc2e70978f3ada3314727d7">libct_init</a> : Version: 0.0.0.f8b97f70.x64.debug</div>
<div class="line">2018-08-01 14:47:45.566 D/libcaretaker (06040) glue_rcv_thread : started.</div>
</div><!-- fragment --><p>The log levels are defined as follows. </p>
<ul>
<li>
D/ &ndash;&gt; Debug </li>
<li>
T/ &ndash;&gt; Trace </li>
<li>
I/ &ndash;&gt; Informational </li>
<li>
W/ &ndash;&gt; Warning </li>
<li>
E/ &ndash;&gt; Error </li>
</ul>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu Oct 11 2018 11:01:55 for Caretaker Library API 1.6.5 Reference Manual by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.6
</small></address>
</body>
</html>
